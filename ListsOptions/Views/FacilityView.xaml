<UserControl
    x:Class="ListsOptionsUI.Views.FacilityView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:helpers="clr-namespace:ListsOptionsUI.Helpers"
    xmlns:local="clr-namespace:ListsOptionsUI.Views"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d">

    <Grid Margin="20">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="1.5*" />
        </Grid.ColumnDefinitions>

        <!--  Лява част  -->
        <StackPanel>
            <!--  Текстово поле за въвеждане  -->
            <TextBox helpers:PlaceholderHelper.PlaceholderText="Въведете хотелско удобство" Text="{Binding NewFacilityName, UpdateSourceTrigger=PropertyChanged}" />

            <!--  Бутон за добавяне  -->
            <Button
                Width="130"
                Height="40"
                Command="{Binding AddFacilityCommand}"
                Content="➕ Добави" />

            <!--  Styled ListBox  -->
            <ListBox MaxHeight="350" ItemsSource="{Binding Facilities}">
                <ListBox.ItemTemplate>
                    <DataTemplate>
                        <Border
                            Margin="5"
                            Padding="10"
                            Background="White"
                            CornerRadius="8">
                            <Border.Effect>
                                <DropShadowEffect
                                    BlurRadius="6"
                                    Opacity="0.15"
                                    ShadowDepth="2" />
                            </Border.Effect>

                            <Grid Height="60">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>

                                <!--  Име  -->
                                <TextBlock
                                    x:Name="FacilityName"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    FontSize="16"
                                    FontWeight="Bold"
                                    Foreground="#333"
                                    Text="{Binding Name}">
                                    <TextBlock.RenderTransform>
                                        <TranslateTransform x:Name="TextTransform" X="0" />
                                    </TextBlock.RenderTransform>
                                </TextBlock>

                                <!--  Бутон за изтриване  -->
                                <Button
                                    x:Name="DeleteButton"
                                    Grid.Column="1"
                                    Width="40"
                                    Height="35"
                                    Background="{StaticResource CloseButtonBrush}"
                                    Command="{Binding DataContext.DeleteFacilityCommand, RelativeSource={RelativeSource AncestorType=ListBox}}"
                                    CommandParameter="{Binding}"
                                    Content="❌"
                                    Visibility="Collapsed">
                                    <Button.RenderTransform>
                                        <TranslateTransform x:Name="ButtonTransform" X="40" />
                                    </Button.RenderTransform>
                                </Button>

                                <!--  Анимации  -->
                                <Grid.Triggers>
                                    <!--  Показване  -->
                                    <EventTrigger RoutedEvent="UIElement.MouseLeftButtonDown">
                                        <BeginStoryboard>
                                            <Storyboard>
                                                <DoubleAnimation
                                                    Storyboard.TargetName="ButtonTransform"
                                                    Storyboard.TargetProperty="X"
                                                    To="0"
                                                    Duration="0:0:0.2" />
                                                <ObjectAnimationUsingKeyFrames Storyboard.TargetName="DeleteButton" Storyboard.TargetProperty="Visibility">
                                                    <DiscreteObjectKeyFrame KeyTime="0:0:0" Value="{x:Static Visibility.Visible}" />
                                                </ObjectAnimationUsingKeyFrames>
                                                <DoubleAnimation
                                                    Storyboard.TargetName="TextTransform"
                                                    Storyboard.TargetProperty="X"
                                                    To="-10"
                                                    Duration="0:0:0.2" />
                                            </Storyboard>
                                        </BeginStoryboard>
                                    </EventTrigger>

                                    <!--  Скриване  -->
                                    <EventTrigger RoutedEvent="UIElement.MouseRightButtonDown">
                                        <BeginStoryboard>
                                            <Storyboard>
                                                <DoubleAnimation
                                                    Storyboard.TargetName="ButtonTransform"
                                                    Storyboard.TargetProperty="X"
                                                    To="40"
                                                    Duration="0:0:0.2" />
                                                <ObjectAnimationUsingKeyFrames Storyboard.TargetName="DeleteButton" Storyboard.TargetProperty="Visibility">
                                                    <DiscreteObjectKeyFrame KeyTime="0:0:0.2" Value="{x:Static Visibility.Collapsed}" />
                                                </ObjectAnimationUsingKeyFrames>
                                                <DoubleAnimation
                                                    Storyboard.TargetName="TextTransform"
                                                    Storyboard.TargetProperty="X"
                                                    To="0"
                                                    Duration="0:0:0.2" />
                                            </Storyboard>
                                        </BeginStoryboard>
                                    </EventTrigger>
                                </Grid.Triggers>
                            </Grid>
                        </Border>
                    </DataTemplate>
                </ListBox.ItemTemplate>
            </ListBox>
        </StackPanel>

        <!--  Дясна част  -->
        <StackPanel Grid.Column="1" Margin="15,0,0,0">
            <local:HotelFacilityEditorView DataContext="{Binding HotelFacilityEditorViewModel}" />
        </StackPanel>
    </Grid>
</UserControl>
